<?xml version="1.0"?>
<!--
/**
 * @author Amasty Team
 * @copyright Copyright (c) 2023 Amasty (https://www.amasty.com)
 * @package Automation Rules for RMA (Add-On) for Magento 2
 */-->
<schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:Setup/Declaration/Schema/etc/schema.xsd">
  <table name="amasty_rma_automation_rules" resource="default" engine="innodb" comment="Amasty Rma Automation Rules Table">
    <column xsi:type="int" name="rule_id" padding="10" unsigned="true" nullable="false" identity="true" comment="ID"/>
    <column xsi:type="varchar" name="name" nullable="false" length="225" comment="Automation Rule Name"/>
    <column xsi:type="boolean" name="status" nullable="false" comment="Status"/>
    <column xsi:type="int" name="priority" padding="10" unsigned="true" nullable="false" identity="false" comment="Priority of rule"/>
    <column xsi:type="boolean" name="further_processing" nullable="false" comment="Is Further Processing Enable"/>
    <column xsi:type="boolean" name="apply_for_new" nullable="false" comment="Is Apply Rule For New Requests"/>
    <column xsi:type="boolean" name="apply_for_existing" nullable="false" comment="Is Apply Rule For Existing Requests"/>
    <column xsi:type="text" name="conditions_serialized" nullable="false" comment="Serialized Conditions"/>
    <constraint xsi:type="primary" referenceId="PRIMARY">
      <column name="rule_id"/>
    </constraint>
  </table>
  <table name="amasty_rma_automation_rule_action" resource="default" engine="innodb" comment="Amasty Rma Automation Rules Actions Table">
    <column xsi:type="int" name="action_id" padding="10" unsigned="true" nullable="false" identity="true" comment="Action ID"/>
    <column xsi:type="int" name="rule_id" padding="10" unsigned="true" nullable="false" identity="false" comment="Rule ID"/>
    <column xsi:type="text" name="type" nullable="false" comment="Rule Type"/>
    <column xsi:type="int" name="value" padding="10" unsigned="true" nullable="false" identity="false" comment="Action Value"/>
    <column xsi:type="text" name="additional_data" nullable="false" comment="Additional Data"/>
    <constraint xsi:type="primary" referenceId="PRIMARY">
      <column name="action_id"/>
    </constraint>
    <constraint xsi:type="foreign" referenceId="FK_4A2F461F8FB3C40D6D61CEA3EBE55A5F" table="amasty_rma_automation_rule_action" column="rule_id" referenceTable="amasty_rma_automation_rules" referenceColumn="rule_id" onDelete="CASCADE"/>
  </table>
</schema>
