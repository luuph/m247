define(["jquery"],function(){"use strict";var a,b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};a=jQuery,b=function(){function a(){}return a.transitions={webkitTransition:"webkitTransitionEnd",mozTransition:"mozTransitionEnd",oTransition:"oTransitionEnd",transition:"transitionend"},a.transition=function(a){var b,c,d,e,f,g;for(c=0,d=a.length;c<d;c++){b=a[c],e=this.transitions;for(g in e)if(f=e[g],null!=b.style[g])return f}},a.execute=function(a,b){var c;return c=this.transition(a),null!=c?a.one(c,b):b()},a}(),d=function(){function b(a){this.url=a}return b.prototype.type=function(){switch(!1){case!this.url.match(/\.(webp|jpeg|jpg|jpe|gif|png|bmp)$/i):return"image";default:return"unknown"}},b.prototype.preload=function(a){var b;return b=new Image,b.src=this.url,b.onload=function(c){return function(){return c.dimensions={width:b.width,height:b.height},a(c)}}(this)},b.prototype.$content=function(){return a("<img />").attr({src:this.url})},b}(),c=function(){function c(b,d){null==d&&(d={}),this.show=e(this.show,this),this.hide=e(this.hide,this),this.observe=e(this.observe,this),this.keyup=e(this.keyup,this),this.size=e(this.size,this),this.align=e(this.align,this),this.process=e(this.process,this),this.resize=e(this.resize,this),this.type=e(this.type,this),this.prev=e(this.prev,this),this.next=e(this.next,this),this.close=e(this.close,this),this.$=e(this.$,this),this.$target=b,this.settings=a.extend({},this.defaults,d),this.$el=a(this.settings.template),this.$overlay=this.$("."+c.namespace+"-overlay"),this.$content=this.$("."+c.namespace+"-content"),this.$container=this.$("."+c.namespace+"-container"),this.$close=this.$("."+c.namespace+"-close"),this.$prev=this.$("."+c.namespace+"-prev"),this.$next=this.$("."+c.namespace+"-next"),this.$body=this.$("."+c.namespace+"-body"),this.dimensions=this.settings.dimensions,this.process()}return c.namespace="lighter",c.prototype.defaults={loading:"#{Lighter.namespace}-loading",fetched:"#{Lighter.namespace}-fetched",padding:40,dimensions:{width:480,height:480},template:"<div class='"+c.namespace+" "+c.namespace+"-fade'>\n  <div class='"+c.namespace+"-container'>\n    <span class='"+c.namespace+"-content'></span>\n    <a class='"+c.namespace+"-close'>&times;</a>\n    <a class='"+c.namespace+"-prev'>&lsaquo;</a>\n    <a class='"+c.namespace+"-next'>&rsaquo;</a>\n  </div>\n  <div class='"+c.namespace+"-spinner'>\n    <div class='"+c.namespace+"-dot'></div>\n    <div class='"+c.namespace+"-dot'></div>\n    <div class='"+c.namespace+"-dot'></div>\n  </div>\n  <div class='"+c.namespace+"-overlay'></div>\n</div>"},c.lighter=function(a,b){var d;return null==b&&(b={}),d=a.data("_lighter"),d||a.data("_lighter",d=new c(a,b)),d},c.prototype.$=function(a){return this.$el.find(a)},c.prototype.close=function(a){return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.hide()},c.prototype.next=function(a){return null!=a&&a.preventDefault(),null!=a?a.stopPropagation():void 0},c.prototype.prev=function(){return"undefined"!=typeof event&&null!==event&&event.preventDefault(),"undefined"!=typeof event&&null!==event?event.stopPropagation():void 0},c.prototype.type=function(a){return null==a&&(a=this.href()),this.settings.type||(this.href().match(/\.(webp|jpeg|jpg|jpe|gif|png|bmp)$/i)?"image":void 0)},c.prototype.resize=function(a){return this.dimensions=a,this.align()},c.prototype.process=function(){var a,b;return a=function(a){return function(){return a.$el.removeClass(c.namespace+"-loading").addClass(c.namespace+"-fetched")}}(this),b=function(a){return function(){return a.$el.removeClass(c.namespace+"-fetched").addClass(c.namespace+"-loading")}}(this),this.slide=new d(this.$target.attr("href")),b(),this.slide.preload(function(b){return function(c){return b.resize(c.dimensions),b.$content.html(b.slide.$content()),a()}}(this))},c.prototype.align=function(){var a;return a=this.size(),this.$container.css({width:a.width,height:a.height,margin:"-"+a.height/2+"px -"+a.width/2+"px"})},c.prototype.size=function(){var b;return b=Math.max(this.dimensions.height/(a(window).height()-this.settings.padding),this.dimensions.width/(a(window).width()-this.settings.padding)),{width:b>1?Math.round(this.dimensions.width/b):this.dimensions.width,height:b>1?Math.round(this.dimensions.height/b):this.dimensions.height}},c.prototype.keyup=function(a){if(null==a.target.form)return 27===a.which&&this.close(),37===a.which&&this.prev(),39===a.which?this.next():void 0},c.prototype.observe=function(b){return null==b&&(b="on"),a(window)[b]("resize",this.align),a(document)[b]("keyup",this.keyup),this.$overlay[b]("click",this.close),this.$close[b]("click",this.close),this.$next[b]("click",this.next),this.$prev[b]("click",this.prev)},c.prototype.hide=function(){var a,d;return a=function(a){return function(){return a.observe("off")}}(this),d=function(a){return function(){return a.$el.remove()}}(this),a(),this.$el.position(),this.$el.addClass(c.namespace+"-fade"),b.execute(this.$el,d)},c.prototype.show=function(){var d,e;return e=function(a){return function(){return a.observe("on")}}(this),d=function(b){return function(){return a(document.body).append(b.$el)}}(this),d(),this.$el.position(),this.$el.removeClass(c.namespace+"-fade"),b.execute(this.$el,e)},c}(),a.fn.extend({lighter:function(b){return null==b&&(b={}),this.each(function(){var d,e,f;return d=a(this),f=a.extend({},a.fn.lighter.defaults,"object"==typeof b&&b),e="string"==typeof b?b:b.action,null==e&&(e="show"),c.lighter(d,f)[e]()})}}),a(document).on("click","[data-lighter]",function(b){return b.preventDefault(),b.stopPropagation(),a(this).lighter()})});