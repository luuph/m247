<?php
/**
 * Mageplaza
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Mageplaza.com license that is
 * available through the world-wide-web at this URL:
 * https://www.mageplaza.com/LICENSE.txt
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 *
 * @category   Mageplaza
 * @package    Mageplaza_PdfInvoice
 * @copyright   Copyright (c) Mageplaza (http://www.mageplaza.com/)
 * @license     https://www.mageplaza.com/LICENSE.txt
 */

?>
<?php
$_shipment = $block->getShipment();
$_order = $block->getOrder();
$storeId = $_order->getStoreId();
$codeType = $block->getCodeType('shipment', $storeId);
$barcodeConfig = $block->getBarcodeConfig($storeId);
$isBarcode = !($codeType === 'no_code');
$pageSize = $block->getPageSize();
$a4Barcode = $isBarcode && ($pageSize == 'A4');
$a5Barcode = $isBarcode && ($pageSize == 'A5');
$columnsConfig = $block->getColumnsConfig('shipment');
$numberColumn = $block->getNumberColumn($columnsConfig, 4);
?>
<?php if ($_shipment && $_order): ?>
    <table class="table-items">
        <tr class="mp-row mp-heading">
            <?php
            foreach ($columnsConfig as $columnConfig) {
                if ($columnConfig['status']) {
                    echo $block->getThImpresiveHtml($columnConfig['name'],$a4Barcode);
                }
            }
            ?>
        </tr>
        <?php $i = 0 ?>
        <?php foreach ($_shipment->getAllItems() as $_item): ?>
            <?php $codeValue = $block->getCodeValue($_item, $storeId) ?>
            <?php
            $block->setItem($_item);
            $indexKey = $i % 2 == 0 ? "odd" : "even";
            if ($block->isBundleItem()) {
                echo /** @noEscape */ $block->renderBundleItem($_item, $_order, $block->getShipmentType(), $indexKey, $codeType, $barcodeConfig, $isBarcode, 'bundleitems5.phtml', $columnsConfig);
                $i++;
                continue;
            }

            if ($_item->getOrderItem()->getParentItem()) {
                continue;
            }
            $i++;
            ?>
            <tr class="mp-row <?= /** @noEscape */ $indexKey ?>" style="border-bottom: 1px solid #ddd;">
                <?php
                foreach ($columnsConfig as $columnConfig) {
                    if ($columnConfig['status']) {
                        echo $block->getTdImpresiveHtml($columnConfig['name'], $a4Barcode, $_item, $codeValue, 'shipment');
                    }
                }
                ?>
            </tr>
            <div class="clr"></div>
        <?php endforeach ?>
    </table>
<?php endif ?>
